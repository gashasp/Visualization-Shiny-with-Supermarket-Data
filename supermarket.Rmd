---
title: "supermarket"
author: "Gasha Sarwono"
date: "4/4/2021"
output: 
  html_document:
    theme: flatly
    higlight: zenburn
    toc: true
    toc_float:
      collapsed: false
---

### 1. Background

#### The growth of supermarkets in most populated cities are increasing and market competitions are also high. The dataset is one of the historical sales of supermarket company which has recorded in 3 different branches for 3 months data.

#### With this data I will analyze and show visualization in intereactive graph/plot about:

#### Analyze 1 : Frequency sales quantity in each city (Frekuensi kuantitas penjualan di masing-masing kota)

#### Analyze 2 : Frequency type payment purchasing on each month (Frekuensi tipe pembayaran pembelian disetiap bulannya)

#### Analyze 3 : Products with the most and least sales of each gender (Produk dengan penjualan paling banyak dan paling sedikit pada setiap gender)

#### My source raw data its from Kaggle:

#### https://www.kaggle.com/aungpyaeap/supermarket-sales


### 2. Set Up
**Import Data**
```{r}
raw_data_supermarket <- read.csv("supermarket_sales - Sheet1.csv", sep=",")
head(raw_data_supermarket)
```

**Activated Library**
```{r message=FALSE, warning=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
library(scales)
library(lubridate)
```


### 3. Subsetting Data
**Choose data needed for analysis**
```{r}
supermarket <- 
  raw_data_supermarket %>% 
  select("City","Quantity","Gender","Product.line", "Date", "Payment")

head(supermarket)
```

### 4. Data InspectIon
**Check data type**
```{r}
glimpse(supermarket)
```

**Change data type**
```{r}
supermarket$City <- as.factor(supermarket$City)
supermarket$Gender <- as.factor(supermarket$Gender)
supermarket$Product.line <- as.factor(supermarket$Product.line)
supermarket$Date <- as.Date(supermarket$Date,"%m/%d/%y")
supermarket$Payment <- as.factor(supermarket$Payment)

glimpse(supermarket)
```

**Check Missing Value**
```{r}
colSums(is.na(supermarket))
```
Data no have missing value

### 5. Subsetting dan Aggregation

**Subsetting dan Aggregation data dilakukan untuk memilih dan mengolah data yang akan kita gunakan untuk visualisasi**


**5.1 Total sales quantity in each city (Jumlah kuantitas penjualan di masing-masing kota)**

Make variabel "data1" to analysis visualization
```{r}
data1 <- supermarket[,c("City","Quantity","Date")]
data1 <- as.data.frame(table(data1$Date,data1$City))
data1 <- setNames(data1,c("Date","City","Quantity"))
data1$Date <- ymd(data1$Date)

data1
```
Make plot based on data1
```{r}
plot1 <- ggplot(data1, aes(x = Date, y = Quantity, color = City)) +
  geom_line()+geom_point()+
  scale_x_date(date_breaks = "10 day",date_labels = "%b-%d") +
  scale_y_continuous(breaks = seq(0,20,2))+
  theme(legend.position = "bottom") +
  theme_minimal() +
  labs(title = "Frequency Sales Quantity On Each City",
       x = "Date", y = "Quantity")

plot1
```

Make Interactive plot based on plot1
```{r}
ggplotly(plot1)
```

**5.2 Frequency type payment purchasing on each month (Frekuensi tipe pembayaran pembelian disetiap bulannya)**

Make variabel "data2" to analysis visualization
```{r}
data2 <- supermarket[,c("Date","Payment")]
data2 <- as.data.frame(table(data2$Date,data2$Payment))
data2 <- setNames(data2,c("Date","Payment","Quantity"))
data2$Date <- ymd(data2$Date)
data2$Month <- month(data2$Date,label=T,abbr = F)
data2

```
Make plot based on data2
```{r}
plot2 <- ggplot(data2,aes(x=Payment, y=Quantity)) +
         geom_col(aes(fill=Month),position = "dodge") +
         theme_minimal() +
         labs(title = "Frequency type payment purchase on each month",
         x = "Payment", y = "Quantity")
  
plot2
```
Make Interactive plot based on plot2
```{r}
ggplotly(plot2)
```

**5.3 Products with the most and least sales of each gender (Produk dengan penjualan paling banyak dan paling sedikit pada setiap gender)**

Make variabel "data3" to analysis visualization
```{r}
data3 <- supermarket[,c("Gender","Product.line")]
data3 <- as.data.frame(table(data3$Gender,data3$Product.line))
data3 <- setNames(data3,c("Gender","Product","Quantity"))
data3
```
Make plot based on data3
```{r}
plot3 <- ggplot(data3,aes(x=Quantity, y=Product)) +
         geom_col(aes(fill=Gender),position="dodge")
plot3
```
Make Interactive plot based on plot3
```{r}
ggplotly(plot3)
```

